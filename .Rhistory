infile <- list.files(path = here::here(),
pattern = "*.xls")
infile
infile <- list.files(path = here::here(),
pattern = "*.xls")[1]
infile
readxl::read_excel(here::here(infile))
library(magrittr)
infile <- list.files(path = here::here(),
pattern = "*.xlsx")[1]
readxl::read_xlsx(here::here(infile))
infile <- list.files(path = here::here(),
pattern = "*.xlsx")
readxl::read_xlsx(here::here(infile))
infile
map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 4))
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 4))
infiles <- list.files(path = here::here(),
pattern = "*.xlsx")
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 4))
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3))
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3)) %>%
dplyr::bind_rows()
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3) %>%
mutate(Filename = .)) %>%
dplyr::bind_rows()
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3) %>%
dplyr::mutate(Filename = .)) %>%
dplyr::bind_rows()
?readxl::read_xlsx
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3)) %>%
dplyr::bind_rows() %>%
filter(Name == "Szyszka, Beth")
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3)) %>%
dplyr::bind_rows()
purrr::map(infiles, ~ readxl::read_xlsx(here::here(.), skip = 3)) %>%
dplyr::bind_rows() %>%
filter(Name == "Szyszka, Beth")
infiles <- list.files(path = here::here(),
pattern = "*.xlsx")
infiles
purrr::map(infiles, ~ mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows()
purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows()
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"))
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
.before = "name",
.keep = "unused")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
.before = "Name",
.keep = "unused")
data
?mutate
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
.before = Name,
.keep = "unused")
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
.keep = "unused")
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
Name = paste(stringr::word(Name, 2, sep = ", "),
stringr::word(Name, 1, sep = ", "))
.keep = "unused")
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
Name = paste(stringr::word(Name, 2, sep = ", "),
stringr::word(Name, 1, sep = ", ")),
.keep = "unused")
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
Name = paste(stringr::word(Name, 2, sep = ", "),
stringr::word(Name, 1, sep = ", ")),
.keep = "unused") %>%
select(Program, CompetitionYear, Name)
data
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
Name = paste(stringr::word(Name, 2, sep = ", "),
stringr::word(Name, 1, sep = ", ")),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, Name)
data
install.packages("scholar")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
FirstName = stringr::word(Name, 2, sep = ", "),
LastNAme = stringr::word(Name, 1, sep = ", "),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, Name)
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
FirstName = stringr::word(Name, 2, sep = ", "),
LastName = stringr::word(Name, 1, sep = ", "),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
scholars <- data %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id())
scholars <- data %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
rlang::last_trace()
scholars <- data %>%
dplyr::mutate(ScholarID = list(scholar::get_scholar_id(LastName, FirstName)))
?scholar::get_scholar_id
scholar::get_scholar_id("Leung", "Arthur")
scholars <- data %>%
rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars <- data %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars <- data[1:3] %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars <- data %>%
slice(3) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars <- data %>%
dplyr::slice(3) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
View(scholars)
scholars <- data %>%
dplyr::slice(10) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars <- data %>%
dplyr::slice(10) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
library(magrittr)
infiles <- list.files(path = here::here(),
pattern = "*.xlsx")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
FirstName = stringr::word(Name, 2, sep = ", "),
LastName = stringr::word(Name, 1, sep = ", "),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
scholars <- data %>%
dplyr::slice(10) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
writexl::write_xlsx(scholars, here::here("scholars.xlsx"))
scholars <- data %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
writexl::write_xlsx(scholars, here::here("scholars.xlsx"))
scholars <- data %>%
head(5) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
library(magrittr)
infiles <- list.files(path = here::here(),
pattern = "*.xlsx")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
FirstName = stringr::word(Name, 2, sep = ", "),
LastName = stringr::word(Name, 1, sep = ", "),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
scholars <- data %>%
head(5) %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
scholars
?scholar::get_scholar_id
infiles
warnings()
scholar::get_scholar_id("Agrawal", "Aneil")
warnings()
temp <- scholar::get_scholar_id("Agrawal", "Aneil")
temp
attr(temp)
?scholar::get_scholar_id
scholar::get_scholar_resp()
?scholar::get_scholar_resp()
scholars <- data %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
data
View(data)
scholars <- data %>%
dplyr::rowwise() %>%
dplyr::mutate(ScholarID = scholar::get_scholar_id(LastName, FirstName))
View(scholars)
infiles
infiles <- list.files(path = here::here(),
pattern = "*.xlsx")
data[1]
data[:1]
data[,1]
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
scholar_ids <- list()
for (name in pull(data, Name) %>% head(3)) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
for (name in dplyr::pull(data, Name) %>% head(3)) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
data
for (name in data %>% dplyr::pull(Name) %>% head(3)) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
data %>% dplyr::pull(Name)
?infiles
infiles
infiles <- list.files(path = here::here(),
pattern = "*[0-9].xlsx")
infiles
infiles <- list.files(path = here::here(),
pattern = "[0-9].xlsx")
infiles
infiles <- list.files(path = here::here(),
pattern = "[0-9].xls.xlsx")
infiles
infiles <- list.files(path = here::here(),
pattern = "[0-9].xls.xlsx")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
scholar_ids <- list()
for (name in data %>% dplyr::pull(Name) %>% head(3)) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
for (name in data  %>% head(3) %>% dplyr::pull(Name)) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
data %>% head(3) %>% dplyr::pull(Name)
names <- data %>% head(3) %>% dplyr::pull(Name)
scholar_ids <- list()
for (name in names) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(Name, 1, sep = ", "),
first_name = stringr::word(Name, 2, sep = ", ")))
}
for (name in names) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(name, 1, sep = ", "),
first_name = stringr::word(name, 2, sep = ", ")))
}
names <- data %>% head(3) %>% dplyr::pull(Name)
scholar_ids <- list()
for (name in names) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(name, 1, sep = ", "),
first_name = stringr::word(name, 2, sep = ", ")))
}
library(magrittr)
infiles <- list.files(path = here::here(),
pattern = "[0-9].xls.xlsx")
data <- purrr::map(infiles, ~ dplyr::mutate(readxl::read_xlsx(here::here(.), skip = 3),
Filename = .)) %>%
dplyr::bind_rows() %>%
dplyr::mutate(Program = stringr::word(Filename, 1, sep = "_"),
CompetitionYear = stringr::word(`Fiscal Year`, 1, sep = "-"),
.keep = "unused") %>%
dplyr::select(Program, CompetitionYear, contains("Name"))
data
names <- data %>% head(3) %>% dplyr::pull(Name)
scholar_ids <- list()
for (name in names) {
scholar_ids <- list(scholar_ids,
name = scholar::get_scholar_id(last_name = stringr::word(name, 1, sep = ", "),
first_name = stringr::word(name, 2, sep = ", ")))
}
